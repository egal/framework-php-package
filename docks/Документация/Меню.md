Меню конструируется на стороне бэкенда, зависит от метаданных, прав доступа и доступных точек входа в систему. Конструктор меню находится в app/Menu.php и заполняется вручную разработчиком. По-умолчанию оно описывается один раз в конструкторе и больше не изменяется. Такой вариант подходит тогда, когда роль у всех, кто видит меню, одна.

Структура файла Menu.php содержит в себе два метода: __construct() и build(). По факту, нужен только последний метод, он используется в модели Metadata, где и происходит запуск метода build() и последующее хранение данных в кэше. В кэше модели Metadata хранится кэш для каждого набора ролей пользователей.

Класс app/Menu.php подключается и инициализируется один раз при запуске сервиса и больше не переинициализируется, поэтому в конструктор выносится то, что может быть инициализировано единожды, а в build() то, что относится к ролевому доступу.

Заполнить данные для каждой роли в отдельности можно в методе build(). Все скрипты, относящиеся к меню будут для каждого набора ролей исполнены единожды, и не будут перезапущены до момента перезапуска микросервиса.

Само меню имеет условно неограниченную вложенность и может быть сгенерировано на основе данных в БД.